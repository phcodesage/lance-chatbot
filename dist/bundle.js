/*! For license information please see bundle.js.LICENSE.txt */
(()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||n(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,u(r.key),r)}}function o(){"use strict";o=function(){return n};var t,n={},r=Object.prototype,a=r.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},c="function"==typeof Symbol?Symbol:{},s=c.iterator||"@@iterator",u=c.asyncIterator||"@@asyncIterator",l=c.toStringTag||"@@toStringTag";function d(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(t){d=function(e,t,n){return e[t]=n}}function p(e,t,n,r){var a=t&&t.prototype instanceof b?t:b,o=Object.create(a.prototype),c=new M(r||[]);return i(o,"_invoke",{value:N(e,n,c)}),o}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}n.wrap=p;var m="suspendedStart",h="suspendedYield",v="executing",g="completed",y={};function b(){}function w(){}function E(){}var x={};d(x,s,(function(){return this}));var S=Object.getPrototypeOf,k=S&&S(S(D([])));k&&k!==r&&a.call(k,s)&&(x=k);var I=E.prototype=b.prototype=Object.create(x);function C(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function L(t,n){function r(o,i,c,s){var u=f(t[o],t,i);if("throw"!==u.type){var l=u.arg,d=l.value;return d&&"object"==e(d)&&a.call(d,"__await")?n.resolve(d.__await).then((function(e){r("next",e,c,s)}),(function(e){r("throw",e,c,s)})):n.resolve(d).then((function(e){l.value=e,c(l)}),(function(e){return r("throw",e,c,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,t){function a(){return new n((function(n,a){r(e,t,n,a)}))}return o=o?o.then(a,a):a()}})}function N(e,n,r){var a=m;return function(o,i){if(a===v)throw Error("Generator is already running");if(a===g){if("throw"===o)throw i;return{value:t,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var s=B(c,r);if(s){if(s===y)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===m)throw a=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=v;var u=f(e,n,r);if("normal"===u.type){if(a=r.done?g:h,u.arg===y)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(a=g,r.method="throw",r.arg=u.arg)}}}function B(e,n){var r=n.method,a=e.iterator[r];if(a===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,B(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var o=f(a,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,y;var i=o.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function M(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function D(n){if(n||""===n){var r=n[s];if(r)return r.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var o=-1,i=function e(){for(;++o<n.length;)if(a.call(n,o))return e.value=n[o],e.done=!1,e;return e.value=t,e.done=!0,e};return i.next=i}}throw new TypeError(e(n)+" is not iterable")}return w.prototype=E,i(I,"constructor",{value:E,configurable:!0}),i(E,"constructor",{value:w,configurable:!0}),w.displayName=d(E,l,"GeneratorFunction"),n.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,E):(e.__proto__=E,d(e,l,"GeneratorFunction")),e.prototype=Object.create(I),e},n.awrap=function(e){return{__await:e}},C(L.prototype),d(L.prototype,u,(function(){return this})),n.AsyncIterator=L,n.async=function(e,t,r,a,o){void 0===o&&(o=Promise);var i=new L(p(e,t,r,a),o);return n.isGeneratorFunction(t)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},C(I),d(I,l,"Generator"),d(I,s,(function(){return this})),d(I,"toString",(function(){return"[object Generator]"})),n.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},n.values=D,M.prototype={constructor:M,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(r,a){return c.type="throw",c.arg=e,n.next=r,a&&(n.method="next",n.arg=t),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=a.call(i,"catchLoc"),u=a.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;T(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:D(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),y}},n}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return(t=u(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(t){var n=function(t,n){if("object"!=e(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var a=r.call(t,"string");if("object"!=e(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(n)?n:n+""}function l(e,t,n,r,a,o,i){try{var c=e[o](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,a)}function d(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){l(o,r,a,i,c,"next",e)}function c(e){l(o,r,a,i,c,"throw",e)}i(void 0)}))}}var p="http://localhost:3001/api",f=function(){var e=d(o().mark((function e(t,n){var r,a,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(p).concat(t),c({},n));case 3:if(a=e.sent,!(null===(r=a.headers.get("content-type"))||void 0===r?void 0:r.includes("application/json"))){e.next=11;break}return e.next=8,a.json();case 8:e.t0=e.sent,e.next=12;break;case 11:e.t0=null;case 12:if(i=e.t0,a.ok){e.next=16;break}throw console.error("API Error:",i),new Error("HTTP error! Status: ".concat(a.status,", Body: ").concat(JSON.stringify(i)));case 16:return e.abrupt("return",c(c({},i),{},{ok:!0}));case 19:return e.prev=19,e.t1=e.catch(0),console.error("Network or other error:",e.t1),e.abrupt("return",{ok:!1});case 23:case"end":return e.stop()}}),e,null,[[0,19]])})));return function(t,n){return e.apply(this,arguments)}}(),m=function(){var e=d(o().mark((function e(t){var n,r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.threadId,r=t.input,e.next=3,f("/threads/".concat(n,"/messages"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({input:r})});case 3:if(!(a=e.sent).ok){e.next=8;break}return e.abrupt("return",c(c({},a),{},{status:200}));case 8:console.error("postMessages Error:",a);case 9:return e.abrupt("return",{status:404});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=function(){var e=d(o().mark((function e(t){var n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.threadId,e.next=3,f("/threads/".concat(n,"/messages"),{method:"GET"});case 3:if(!(r=e.sent).ok){e.next=8;break}return e.abrupt("return",c(c({},r),{},{status:200}));case 8:console.error("getMessages Error:",r);case 9:return e.abrupt("return",{status:404});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=d(o().mark((function e(t){var n,r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.threadId,r=t.assistant_id,e.next=3,f("/threads/".concat(n,"/runs"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({assistant_id:r})});case 3:if(!(a=e.sent).ok){e.next=8;break}return e.abrupt("return",c(c({},a),{},{status:200}));case 8:console.error("runThread Error:",a);case 9:return e.abrupt("return",{status:404});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=d(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f("/threads",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tool_resources:{file_search:{vector_store_ids:[]},code_interpreter:{file_ids:[]}}})});case 2:if(!(t=e.sent).ok){e.next=7;break}return e.abrupt("return",{id:t.id,status:200});case 7:console.error("createThread Error:",t);case 8:return e.abrupt("return",{status:404});case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),y=function(e){return new Promise((function(t){return setTimeout(t,e)}))};function b(e,t){var n=document.getElementById(t),r=n.innerHTML,a=n.innerText;navigator.clipboard.write([new ClipboardItem({"text/html":new Blob([r],{type:"text/html"}),"text/plain":new Blob([a],{type:"text/plain"})})]).then((function(){e.textContent="Copied!",setTimeout((function(){e.textContent="Copy"}),2e3)})).catch((function(e){return console.error("Error copying text: ",e)}))}function w(e,t){var n=document.createElement("div");n.className="assistant-message-container";var r=document.createElement("div");r.className="message assistant-message";var a=document.createElement("div");a.className="copy-btn-container";var o=document.createElement("button");o.className="copy-btn",o.textContent="Copy",o.addEventListener("click",(function(){b(this,t)}));var i=document.createElement("button");i.className="save-btn",i.textContent="Save to Note",i.addEventListener("click",(function(){P(this,e,t)}));var c=document.createElement("button");c.className="edit-btn",c.textContent="Edit",c.addEventListener("click",(function(){E(this,t)}));var s=document.createElement("div");return s.id=t,s.innerHTML=S(e),r.appendChild(a),a.appendChild(o),a.appendChild(i),a.appendChild(c),r.appendChild(s),n.appendChild(r),n}function E(e,t){var n=document.getElementById(t);n&&(n.contentEditable="true",n.style.border="1px solid #ccc",n.style.padding="10px",n.style.borderRadius="5px",n.focus(),e.textContent="Save",e.onclick=function(){!function(e,t){x.apply(this,arguments)}(e,t)})}function x(){return(x=d(o().mark((function e(t,n){var r,a,i,c,s,u,l,d,p,f,m,h,v,g,y,b,w,x,S,k;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=document.getElementById(n)){e.next=3;break}return e.abrupt("return");case 3:if(a=r.innerHTML.trim(),i=(new Date).toISOString().split("T")[0],c=new DOMParser,s=c.parseFromString(a,"text/html"),u=s.body.firstChild?s.body.firstChild.innerText.trim():"",!(l=document.querySelector('.file[data-note-id="'.concat(n,'"]')))){e.next=35;break}return d=l.getAttribute("data-original-text"),p=d.match(/\((\d{4}-\d{2}-\d{2})\)/),f=p?p[1]:i,m="".concat(u," (").concat(f,') <span style="color: gray; font-weight: 200">(Edited ').concat(i,")</span>"),l.setAttribute("data-original-text","".concat(u," (").concat(f,")")),l.innerHTML='<span style="color: rgb(0, 191, 255);">• </span>'.concat(m),h=localStorage.getItem("currentClientId"),v=z(h),g=l.getAttribute("data-note-type"),y=JSON.parse(v[g]||"[]"),-1!==(b=y.findIndex((function(e){return e.id===n})))&&(y[b].document=a),v[g]=JSON.stringify(y),X(h,v),e.next=26,O.client.update(v);case 26:if(200===e.sent.status){e.next=30;break}return console.error("Failed to update note in API"),e.abrupt("return");case 30:(w=document.getElementById("sidebar")).innerHTML="",R(w,$("clients")),(x=l.closest(".folder"))&&(S=x.querySelector("ul"))&&S.classList.remove("hidden");case 35:for(r.innerHTML=a,k=r.getElementsByTagName("h3");k[0];)k[0].parentNode.removeChild(k[0]);r.contentEditable="false",r.style.border="none",r.style.padding="0",t.textContent="Edit",t.onclick=function(){E(t,n)},ae("Note saved successfully!"),M.close("DocumentModal");case 45:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e){return(new showdown.Converter).makeHtml(e)}function k(e,t){var n=document.createElement("div");n.className="user-message-container";var r=document.createElement("div");r.className="message user-message";var a=document.createElement("div");a.className="copy-btn-container";var o=document.createElement("button");o.className="copy-btn",o.textContent="Copy",o.addEventListener("click",(function(){b(this,t)}));var i=document.createElement("button");i.className="edit-btn",i.textContent="Edit",i.addEventListener("click",(function(){E(this,t)}));var c=document.createElement("div");return c.id=t,c.innerHTML=S(e),r.appendChild(a),a.appendChild(o),a.appendChild(i),r.appendChild(c),n.appendChild(r),n}var I=function(e){var t=document.getElementById("message-input"),n=document.getElementById("sendButton"),r=document.getElementById("newButton"),a=document.getElementById("openSessionNoteModal");document.getElementById("loader").style.display=e?"flex":"none",t.disabled=e,n.disabled=e,r.disabled=e,a.disabled=e};function C(){return L.apply(this,arguments)}function L(){return(L=d(o().mark((function e(){var t,n,r,a,i,c,s,u,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=document.getElementById("message-input"),n=t.value.trim(),t.value="",I(!0),""===n){e.next=49;break}if(r=V(),a=k(S(n),r),document.getElementById("chat-box").appendChild(a),(i=localStorage.getItem("threadId"))&&"undefined"!==i){e.next=21;break}return e.next=12,g();case 12:if(c=e.sent,s=c.id,404!==c.status){e.next=19;break}return ae("Something went wrong during creating the thread"),I(!1),e.abrupt("return");case 19:i=s,localStorage.setItem("threadId",s);case 21:return e.next=23,m({threadId:i,input:n});case 23:if(200!==e.sent.status){e.next=46;break}return e.next=27,v({threadId:i,assistant_id:"asst_LdAem8sJLT0P7wA0Br5XkG3q"});case 27:if(200!==e.sent.status){e.next=41;break}u=o().mark((function e(){var t,n,r,a,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y(2e3);case 2:return e.next=4,h({threadId:i});case 4:if(200!==(t=e.sent).status){e.next=16;break}if(!("assistant"===(n=t.data[0]).role&&n.content.length>0)){e.next=14;break}return r=t.data.find((function(e){return e.id===t.first_id})),a=r.content[0].text.value,c=w(a,r.id),document.getElementById("chat-box").appendChild(c),document.getElementById("chat-box").scrollTop=document.getElementById("chat-box").scrollHeight,e.abrupt("return",0);case 14:e.next=19;break;case 16:return ae("Something went wrong during getting response from API"),I(!1),e.abrupt("return",{v:void 0});case 19:case"end":return e.stop()}}),e)}));case 30:return e.delegateYield(u(),"t0",32);case 32:if(0!==(l=e.t0)){e.next=35;break}return e.abrupt("break",39);case 35:if(!l){e.next=37;break}return e.abrupt("return",l.v);case 37:e.next=30;break;case 39:e.next=44;break;case 41:return ae("Something went wrong during running the thread"),I(!1),e.abrupt("return");case 44:e.next=49;break;case 46:return ae("Something went wrong during posting message."),I(!1),e.abrupt("return");case 49:I(!1);case 50:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(){return B.apply(this,arguments)}function B(){return(B=d(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D.show(),e.next=3,g();case 3:200===(t=e.sent).status?localStorage.setItem("threadId",t.id):ae("Something went Wrong During New Thread. May Be Your API KEY OR Assistant ID Is Invalid."),document.getElementById("chat-box").innerHTML="",D.hide();case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var O={client:new(function(){return e=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=t,this.tableName=n},t=[{key:"fetchData",value:(c=d(o().mark((function e(t){var n,r,a,i=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:{},e.prev=1,e.next=4,fetch(t,n);case 4:if((r=e.sent).ok){e.next=10;break}return e.next=8,r.text();case 8:throw a=e.sent,new Error("HTTP error! Status: ".concat(r.status,", Message: ").concat(a));case 10:return e.abrupt("return",r.json());case 13:throw e.prev=13,e.t0=e.catch(1),console.error("Fetch Error:",e.t0),e.t0;case 17:case"end":return e.stop()}}),e,null,[[1,13]])}))),function(e){return c.apply(this,arguments)})},{key:"buildUrl",value:function(e){var t=new URLSearchParams(e);return"".concat(this.url,"?").concat(t)}},{key:"get",value:(i=d(o().mark((function e(){var t,n,r,a=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={action:(t=a.length>0&&void 0!==a[0]?a[0]:null)?"getById":"read",sheetName:this.tableName,id:t},r=this.buildUrl(n),e.abrupt("return",this.fetchData(r));case 4:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"post",value:(r=d(o().mark((function e(t){var n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={action:"write",sheetName:this.tableName},r=this.buildUrl(n),e.abrupt("return",this.fetchData(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"update",value:(n=d(o().mark((function e(t){var n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={action:"update",sheetName:this.tableName},r=this.buildUrl(n),e.abrupt("return",this.fetchData(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})}],t&&a(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r,i,c}())("http://localhost:3001/api","Client")};function T(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(e.innerHTML="",0===t.length){var r=new Option("No Option Available","");r.disabled=!0,e.add(r)}else{if(n){var a=new Option("Select One","");e.add(a)}t.forEach((function(t){var n=new Option(t.name,t.id);e.add(n)}))}}var M={open:function(e){new bootstrap.Modal(document.getElementById(e)).show()},close:function(e){var t=document.getElementById(e),n=bootstrap.Modal.getInstance(t);n?n.hide():new bootstrap.Modal(t).hide()}},D={show:function(){document.getElementById("loader").style.display="flex"},hide:function(){document.getElementById("loader").style.display="none"}},P=function(e,t,n){var r=document.getElementById("SaveModalPlanId"),a=document.getElementById("SaveModalDocument"),o=document.getElementById("SaveModalClientNameSelect"),i=document.getElementById("SaveModalDatepicker");if(r&&a&&o&&i){r.value=n,a.value=t,T(o,ne());var c=localStorage.getItem("selectedClientId")||j(n);c&&(o.value=c,o.dispatchEvent(new Event("change")));var s=(new Date).toISOString().split("T")[0];i.value=s,M.open("SaveModal")}else console.error("One or more elements not found in handleSaveBtn function.")},j=function(e){var t,r=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=n(e))){r&&(e=r);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return c=e.done,e},e:function(e){s=!0,i=e},f:function(){try{c||null==r.return||r.return()}finally{if(s)throw i}}}}($("clients")||[]);try{for(r.s();!(t=r.n()).done;){var a=t.value;if(JSON.parse(a.treatmentplan||"[]").some((function(t){return t.id===e})))return a.id}}catch(e){r.e(e)}finally{r.f()}return null},A=function(){document.getElementById("SaveModalAddClientBtn").addEventListener("click",(function(){return"SaveModalAddClientBtn","SaveModalClientNameSelect","SaveModalClientNameInput",e=document.getElementById("SaveModalAddClientBtn"),t=document.getElementById("SaveModalClientNameSelect"),n=document.getElementById("SaveModalClientNameInput"),void("none"!==t.style.display?(e.textContent="Select",t.style.display="none",n.style.display="block",n.required=!0,t.required=!1):(e.textContent="+ Add",t.style.display="block",n.style.display="none",n.required=!1,n.value="",t.required=!0));var e,t,n}));var e=document.getElementById("SaveModalForm");e.addEventListener("submit",function(){var t=d(o().mark((function t(n){var r,a;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),r=new FormData(e),a={clientName:r.get("clientName"),clientId:r.get("clientId"),planId:r.get("planId"),planName:r.get("planName"),planType:"treatmentplan",date:r.get("date"),document:r.get("document")},t.next=5,Q(a);case 5:M.close("SaveModal"),e.reset();case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},_=function(){document.getElementById("openSessionNoteModal").addEventListener("click",(function(){var e=ne(),t=document.getElementById("SessionNoteModalClientNameSelect");T(t,e);var n=localStorage.getItem("selectedClientId");n&&(t.value=n,t.dispatchEvent(new Event("change"))),t.addEventListener("change",(function(e){var t=e.target.value,n=z(t);if(n){var r=JSON.parse(n.treatmentplan||"[]");r.sort((function(e,t){return new Date(t.date)-new Date(e.date)}));var a=r.map((function(e){return{id:e.id,name:e.name}})),o=document.getElementById("SessionNoteModalTreatmentPlanSelect");if(o.innerHTML="",T(o,a),a.length>0)o.value=a[0].id;else{var i=new Option("No treatment plan","");i.disabled=!0,o.add(i),o.value=""}}else ae("Client not found with id: "+t)})),M.open("SessionNoteModal")}));var e=document.getElementById("SessionNoteModalForm");e.addEventListener("submit",function(){var t=d(o().mark((function t(n){var r,a,i,c;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.preventDefault(),r=new FormData(e),a=[],r.getAll("modalities").forEach((function(e){e&&a.push(e)})),i={clientId:r.get("clientId"),treatmentPlans:r.get("treatmentPlans"),comments:r.get("comments"),telehealth:"on"===r.get("telehealth"),modalities:a},c=re(i),M.close("SessionNoteModal"),e.reset(),document.getElementById("message-input").value=c;case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},F=function(){var e=$("clients")||[],t=document.getElementById("sidebar");t.innerHTML="",R(t,e)},H=function(){var e=document.getElementById("sidebarAddNewClientContainer"),t=document.getElementById("sidebarAddNewClientBtn");t.addEventListener("click",(function(){var n=t.textContent;t.textContent="Close"===n?"+ Add":"Close",e.classList.toggle("d-none")})),document.getElementById("sidebarNewClientNameSaveBtn").addEventListener("click",d(o().mark((function n(){var r;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=document.getElementById("sidebarNewClientName"),n.next=3,te(null==r?void 0:r.value);case 3:e.classList.toggle("d-none"),t.textContent="+ Add",r.value="";case 6:case"end":return n.stop()}}),n)}))))};function J(e,t){var n=new Date(e.date);return new Date(t.date)-n}function G(e){var t=document.querySelector('.file[data-note-id="'.concat(e,'"]'));t&&t.parentElement.removeChild(t)}function q(e,t,n){var r=document.createElement("li");r.classList.add("folder"),r.textContent=e;var a=document.createElement("ul");return a.classList.add("dotted"),a.classList.add("hidden"),t.sort(J).forEach((function(t){var r=document.createElement("li");r.classList.add("file");var o=t.name||t.document.split("\n")[0].replace(/<\/?[^>]+(>|$)/g,""),i="".concat(o," (").concat(t.date,")"),c=document.createElement("span");c.textContent="• ",c.style.color="#00BFFF",r.appendChild(c),r.appendChild(document.createTextNode(i)),r.setAttribute("data-note-id",t.id),r.setAttribute("data-note-type",e.toLowerCase().replace(" ","")),r.setAttribute("data-original-text",i),r.addEventListener("click",(function(r){r.stopPropagation(),document.getElementById("DocumentModalLabel").textContent=o.toUpperCase();var a=document.getElementById("DocumentModalDocumentDiv");a.innerHTML="",a.innerHTML=S(t.document),a.setAttribute("data-note-id",t.id),a.setAttribute("data-note-type",e.toLowerCase().replace(" ","")),localStorage.setItem("currentClientId",n),document.getElementById("DocumentModalCoptBtn").addEventListener("click",(function(){b(this,"DocumentModalDocumentDiv")})),M.open("DocumentModal")})),a.appendChild(r)})),r.appendChild(a),r}var R=function(e,t){var n=document.createElement("ul");n.classList.add("empty-dotted"),t.forEach((function(e){var t=document.createElement("li");t.classList.add("folder"),t.textContent=e.clientname;var r=document.createElement("ul");r.classList.add("arrow"),r.classList.add("hidden"),r.appendChild(q("Treatment Plan",JSON.parse(e.treatmentplan||"[]"),e.id)),r.appendChild(q("Intake Note",JSON.parse(e.intakenote||"[]"),e.id)),r.appendChild(q("Session Note",JSON.parse(e.sessionnote||"[]"),e.id)),t.appendChild(r),n.appendChild(t),t.addEventListener("click",(function(t){t.stopPropagation(),localStorage.setItem("selectedClientId",e.id)}))})),e.appendChild(n),document.querySelectorAll(".folder").forEach((function(e){e.addEventListener("click",(function(t){t.stopPropagation();var n=e.querySelector("ul");n&&n.classList.toggle("hidden")}))}))};function U(e,t){var n=document.querySelector('.file[data-note-id="'.concat(e,'"]'));if(n){var r=(new DOMParser).parseFromString(t,"text/html"),a=r.body.firstChild?r.body.firstChild.innerText.trim():"",o=(new Date).toISOString().split("T")[0],i=n.getAttribute("data-original-text").match(/\((\d{4}-\d{2}-\d{2})\)/),c=i?i[1]:o,s="".concat(a," (").concat(c,') <span style="color: gray; font-weight: 200">(Edited ').concat(o,")</span>");n.setAttribute("data-original-text","".concat(a," (").concat(c,")")),n.innerHTML='<span style="color: rgb(0, 191, 255);">• </span>'.concat(s)}}function V(){var e=(new Date).getTime(),t=Math.random().toString(36).substring(2,15);return"client_".concat(e,"_").concat(t)}document.getElementById("DocumentModalDeleteBtn").addEventListener("click",d(o().mark((function e(){var t,n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=document.getElementById("DocumentModalDocumentDiv").getAttribute("data-note-id"),n=localStorage.getItem("currentClientId"),r=document.getElementById("DocumentModalDocumentDiv").getAttribute("data-note-type"),t&&n&&r){e.next=6;break}return ae("Error: Note ID, Client ID, or Note Type is missing."),e.abrupt("return");case 6:return e.prev=6,e.next=9,fetch("".concat(p,"/clients/").concat(n,"/notes/").concat(t,"?noteType=").concat(r),{method:"DELETE"});case 9:e.sent.ok?(ae("Note deleted successfully."),M.close("DocumentModal"),G(t),F()):ae("Failed to delete note."),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(6),console.error("Error deleting note:",e.t0),ae("Failed to delete note.");case 17:case"end":return e.stop()}}),e,null,[[6,13]])}))));var Y=function(){var e=d(o().mark((function e(){var t,n,r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D.show(),localStorage.clear(),e.prev=2,e.next=5,O.client.get();case 5:t=e.sent,n=t.status,r=t.data,a=t.message,200===n?localStorage.setItem("clients",JSON.stringify(r)):ae("Error fetching clients: ".concat(a)),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(2),console.error("Error Fetching Clients:",e.t0),ae("Failed to Fetch clients: ".concat(e.t0.message));case 14:return e.prev=14,D.hide(),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[2,10,14,17]])})));return function(){return e.apply(this,arguments)}}(),$=function(e){var t=localStorage.getItem(e);try{return JSON.parse(t)}catch(e){return}},K=function(e,t){localStorage.setItem(e,JSON.stringify(t))},W=function(e){var n=$("clients")||[];K("clients",[].concat(t(n),[e]))},X=function(e,n){var r=($("clients")||[]).filter((function(t){return t.id!==e}));K("clients",[].concat(t(r),[n]))},z=function(e){return($("clients")||[]).find((function(t){return t.id===e}))},Q=function(){var e=d(o().mark((function e(t){var n,r,a,i,c,s,u,l,d;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.planType,r=t.clientName,a=t.clientId,i=t.planName,c=t.planId,s=t.date,u=t.document,l=n.toLowerCase(),d={id:c,name:i,document:u,date:s},D.show(),!r){e.next=9;break}return e.next=7,Z(r,l,d);case 7:e.next=11;break;case 9:return e.next=11,ee(a,l,d);case 11:D.hide();case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Z=function(){var e=d(o().mark((function e(t,n,r){var a,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=s({id:V(),clientname:t},n,JSON.stringify([r])),e.prev=1,e.next=4,O.client.post(a);case 4:200===(i=e.sent).status?(console.log(i.message),W(a),o=r.id,void 0,u=void 0,(u=(null==(c=document.getElementById(o))?void 0:c.previousElementSibling).querySelector(".save-btn"))&&(u.style.display="none"),F()):ae("Error: ".concat(i.message)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),ae("Failed to save client: ".concat(e.t0));case 11:case"end":return e.stop()}var o,c,u}),e,null,[[1,8]])})));return function(t,n,r){return e.apply(this,arguments)}}(),ee=function(){var e=d(o().mark((function e(t,n,r){var a,i,u,l,d;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=z(t)){e.next=4;break}return ae("Client not found with id: "+t),e.abrupt("return");case 4:return i=JSON.parse(a[n]||"[]"),-1!==(u=i.findIndex((function(e){return e.id===r.id})))?i[u]=r:i.push(r),l=c(c({},a),{},s({},n,JSON.stringify(i))),e.prev=8,e.next=11,O.client.update(l);case 11:200===(d=e.sent).status?(X(t,l),ae("Client updated successfully."),F()):ae("Error: ".concat(d.message)),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(8),ae("Failed to update client: ".concat(e.t0));case 18:case"end":return e.stop()}}),e,null,[[8,15]])})));return function(t,n,r){return e.apply(this,arguments)}}(),te=function(){var e=d(o().mark((function e(t){var n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={id:V(),clientname:t},D.show(),e.prev=2,e.next=5,O.client.post(n);case 5:200===(r=e.sent).status?(console.log(r.message),W(n),F()):ae("Error: ".concat(r.message)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),ae("Failed to save client: ".concat(e.t0));case 12:D.hide();case 13:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}(),ne=function(){return($("clients")||[]).map((function(e){return{id:e.id,name:e.clientname}}))};function re(e){var t=e.clientId,n=e.comments,r=e.treatmentPlans,a=e.telehealth,o=e.modalities,i=z(t);if(i){var c=JSON.parse(i.treatmentplan||"[]").find((function(e){return e.id===r}));if(c){var s=a?"Create new session note, telehealth":"Create new session note",u=c.document.replace(/<\/?[^>]+(>|$)/g,""),l=c.name,d=o.length?"".concat(o.join(", ")):"";return"".concat(s,"\n\nHere is the client current treatment plan (").concat(l,"):\n").concat(u,"\n\nSession details: ").concat(n,".\n").concat(d,"\n")}ae("Treatment Plan not found with id: "+r)}else ae("Client not found with id: "+t)}function ae(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"primary",n=document.getElementById("notification-container"),r=document.createElement("div");r.className="notification alert alert-".concat(t," show"),r.innerHTML="\n    <span>".concat(e,'</span>\n    <button class="close-btn" onclick="this.parentElement.remove()">×</button>\n  '),n.appendChild(r),setTimeout((function(){r.remove()}),3e3)}function oe(){var e=document.getElementById("expandButton"),t=document.getElementById("message-input"),n=document.getElementById("expandIcon");e.addEventListener("click",(function(){t.classList.toggle("expanded"),t.classList.contains("expanded")?n.innerHTML='\n        <g id="SVGRepo_bgCarrier" stroke-width="0"></g>\n        <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round" stroke="#CCCCCC" stroke-width="0.16"></g>\n        <g id="SVGRepo_iconCarrier">\n          <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n            <g id="Dribbble-Light-Preview" transform="translate(-220.000000, -6684.000000)" fill="#ffff">\n              <g id="icons" transform="translate(56.000000, 160.000000)">\n                <path d="M164.292308,6524.36583 L164.292308,6524.36583 C163.902564,6524.77071 163.902564,6525.42619 164.292308,6525.83004 L172.555873,6534.39267 C173.33636,6535.20244 174.602528,6535.20244 175.383014,6534.39267 L183.70754,6525.76791 C184.093286,6525.36716 184.098283,6524.71997 183.717533,6524.31405 C183.328789,6523.89985 182.68821,6523.89467 182.29347,6524.30266 L174.676479,6532.19636 C174.285736,6532.60124 173.653152,6532.60124 173.262409,6532.19636 L165.705379,6524.36583 C165.315635,6523.96094 164.683051,6523.96094 164.292308,6524.36583" id="arrow_down-[#338]"></path>\n              </g>\n            </g>\n          </g>\n        </g>\n      ':n.innerHTML='\n        <g id="SVGRepo_bgCarrier" stroke-width="0"></g>\n        <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>\n        <g id="SVGRepo_iconCarrier">\n          <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n            <g id="Dribbble-Light-Preview" transform="translate(-140.000000, -6683.000000)" fill="#ffffff">\n              <g id="icons" transform="translate(56.000000, 160.000000)">\n                <path d="M84,6532.61035 L85.4053672,6534 L94.0131154,6525.73862 L94.9311945,6526.61986 L94.9261501,6526.61502 L102.573446,6533.95545 L104,6532.58614 C101.8864,6530.55736 95.9854722,6524.89321 94.0131154,6523 C92.5472155,6524.40611 93.9757869,6523.03486 84,6532.61035" id="arrow_up[#340]"></path>\n              </g>\n            </g>\n          </g>\n        </g>\n      '}))}document.addEventListener("DOMContentLoaded",d(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y();case 2:document.getElementById("newButton").addEventListener("click",N),document.getElementById("sendButton").addEventListener("click",C),_(),A(),document.getElementById("DocumentModalInsertBtn").addEventListener("click",(function(){var e=document.getElementById("DocumentModalDocumentDiv").innerText;M.close("DocumentModal");var t=document.getElementById("message-input"),n=t.selectionStart,r=t.value.substring(0,n),a=t.value.substring(n);t.value=r+e+a,t.selectionStart=t.selectionEnd=n+e.length,t.focus()})),document.getElementById("DocumentModalEditBtn").addEventListener("click",d(o().mark((function e(){var t,n,r,a,i,c,s,u,l,d,p,f;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=document.getElementById("DocumentModalDocumentDiv"),"Edit"!==(n=this).textContent){e.next=11;break}t.contentEditable="true",t.style.border="1px solid #ccc",t.style.padding="10px",t.style.borderRadius="5px",t.focus(),n.textContent="Save",e.next=38;break;case 11:return r=t.getAttribute("data-note-id"),a=localStorage.getItem("currentClientId"),i=t.getAttribute("data-note-type"),c=t.innerHTML.trim(),e.prev=15,s=z(a),u=JSON.parse(s[i]||"[]"),-1!==(l=u.findIndex((function(e){return e.id===r})))&&(u[l].document=c),s[i]=JSON.stringify(u),e.next=23,O.client.update(s);case 23:200===(d=e.sent).status?(X(a,s),ae("Note updated successfully."),(p=document.getElementById("sidebar")).innerHTML="",R(p,$("clients")),U(r,c)):ae("Error: ".concat(d.message)),e.next=31;break;case 27:e.prev=27,e.t0=e.catch(15),console.error("Error updating note:",e.t0),ae("Failed to update note.");case 31:for(f=t.getElementsByTagName("h3");f[0];)f[0].parentNode.removeChild(f[0]);t.contentEditable="false",t.style.border="none",t.style.padding="0",n.textContent="Edit",M.close("DocumentModal");case 38:case"end":return e.stop()}}),e,this,[[15,27]])})))),F(),H(),oe();case 10:case"end":return e.stop()}}),e)}))))})();